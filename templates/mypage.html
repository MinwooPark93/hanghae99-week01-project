<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Hi+Melody&display=swap"
      rel="stylesheet"
    />

    <script src="http://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
      integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
      crossorigin="anonymous"
    ></script>

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />

    <link rel="stylesheet" href="../static/css/style.css" />

    <title>My Page | ì–´ì„œì˜¤'ì‰ì–´'</title>

    <script>
      $(document).ready(function () {

          {#ë‚˜ì˜ í˜ì´ì§€ ì…ì¥ì‹œ ë‚´ ë‹¤ì´ì–´ë¦¬ í™œì„±í™”#}
          show_diarys()

          {#ì•„ì´ë””ì— ë”°ë¥¸ í•¨ìˆ˜ í˜¸ì¶œ#}
          $('a[data-toggle="pill"]').on('show.bs.tab', function (e) {
              if(this.id == 'my_diary')
                  show_diarys()
              else if(this.id == 'my_like_diary')
                  like_list()
          });
      })


      {#ë‹¤ì´ì–´ë¦¬ ë³´ì—¬ì£¼ê¸°#}
      function show_diarys() {
          {#ê·¸ë ¤ì§„ ë‹¤ì´ì–´ë¦¬ ì œê±°#}
          $('#my_link').empty()
          $('#list_link').empty()

          $.ajax({
              type: "GET",
              url: "/pictures",
              data: {},
              success: function (response) {
                  let rows = response['diaries']

                  {#ë‹¤ì´ì–´ë¦¬ ì „ì²´ ê²€ìƒ‰#}
                  for (let i = 0; i < rows.length; i++) {

                      {#ë‚´ê°€ ì“´ ê¸€ì´ë©´ ì¶”ê°€#}
                      if (document.getElementById("user_name").innerText == rows[i]['username']) {
                          let img = rows[i]['file']
                          let content = rows[i]['content']

                          let temp_html = `<div class="tab-my-write col-md">
                                      <img class="room-img" src="../static/${img}">
                                      <p class="room-title">${content}</p>
                                  </div>`

                          $('#my_link').append(temp_html)
                      }
                  }
              }
          })
      }

      {#ì¢‹ì•„ìš” ë¦¬ìŠ¤íŠ¸#}
      function like_list() {
          $('#my_link').empty()
          $('#list_link').empty()

          $.ajax({
              type: "GET",
              url: "/",
              data: {},
              success: function (response) {
                  {#console.log(response)#}
              }
          })
      }

      // function my_profile_set() {
      //     $('#contents-list').empty()
      // }
    </script>
  </head>
  <body>
    <div class="wrap">
      <!-- ë„¤ë¹„ê²Œì´ì…˜ êµ¬ì—­ -->
      <header>
        <div class="nav-bar">
          <div class="nav-bar_first-box">
            <a href="/">í™ˆ</a>
          </div>
          <div class="nav-bar_second-box">
            <a href="/">ë¡œê·¸ì•„ì›ƒ</a>
          </div>
        </div>
      </header>
      <!-- ë„¤ë¹„ê²Œì´ì…˜ ë -->

      {# ë§ˆì´í˜ì´ì§€ ì‹œì‘#}
      <div class="mypage-center">
        ğŸ˜ <span id="user_name">{{ user_info['username'] }}</span>ë‹˜ì˜
        ë§ˆì´í˜ì´ì§€ ğŸ¥°
      </div>

      {# ëª©ë¡ ë²„íŠ¼#}
      <ul class="mypage-nav nav nav-pills mb-3" id="pills-tab" role="tablist">
        <li class="nav-item">
          <a
            class="nav-link active"
            id="my_diary"
            data-toggle="pill"
            href="#my_link"
            role="tab"
            aria-controls="my_link"
            aria-selected="true"
            >ë‚´ê°€ ì“´ ê¸€</a
          >
        </li>
        <li class="nav-item">
          <a
            class="nav-link"
            id="my_like_diary"
            data-toggle="pill"
            href="#list_link"
            role="tab"
            aria-controls="list_link"
            aria-selected="false"
            >ì¢‹ì•„ìš” ë¦¬ìŠ¤íŠ¸</a
          >
        </li>
      </ul>
      {# ëª©ë¡ ë‚´ìš©#}
      <div class="mypage-nav_list" id="contents-list">
        <div
          class="tab-pane row show active"
          id="my_link"
          role="tabpanel"
          aria-labelledby="my_diary"
        ></div>
        <div
          class="tab-pane row"
          id="list_link"
          role="tabpanel"
          aria-labelledby="my_like_diary"
        ></div>
      </div>
    </div>
    {# ë§ˆì´í˜ì´ì§€ ë#}

    <script></script>
  </body>
</html>
